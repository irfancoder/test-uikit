.multiselect {
    @apply block relative min-h-10 text-left text-base border rounded cursor-pointer;
    min-width: calc(96px + 40px);
    @include utils-gradient(#f3f5f7, #ffffff);

    &:focus {
        @apply outline-none;
    }

    * {
        box-sizing: border-box;
    }

    &--disabled {
        @apply pointer-events-none opacity-50 cursor-not-allowed bg-misc-500;
    }

    &--active {
        @apply z-50;

        &:not(.multiselect--above) {
            & .multiselect__current,
            & .multiselect__input,
            & {
                @apply rounded-b-none #{!important};
            }
        }

        .multiselect__select {
            @apply transform rotate-180;
        }

        .multiselect__placeholder {
            @apply hidden;
        }
    }

    &__tags {
        @apply pt-2 px-4 h-full;

        & ~ .multiselect__input,
        & ~ .multiselect__single {
            @apply w-auto;
        }

        &-wrap {
            @apply inline;
        }
    }

    &__tag {
        @apply bg-black-100 relative inline-flex rounded mr-2 text-black-500 leading-normal mb-1 whitespace-nowrap overflow-hidden max-w-full truncate;
        padding: 4px 26px 4px 10px;

        &-icon {
            @apply ml-2 absolute right-0 bottom-0 font-bold text-center rounded;
            font-style: normal;
            top: 3px;
            width: 22px;
            line-height: 22px;
            transition: all 0.2s ease;

            &::after {
                @apply cursor-pointer text-black-300;
                content: "\D7";
                font-size: 14px;
            }

            &:focus,
            &:hover {
                &::after {
                    @apply text-blue-500;
                }
            }
        }
    }

    &__select {
        @apply absolute w-10 py-1 px-2 text-center;
        height: 38px;
        right: 0;
        top: 0;
        transition: transform 0.2s ease;

        &::before {
            @apply relative right-0 mt-1;
            top: 65%;
            color: #999;
            border-color: #999 transparent transparent;
            border-style: solid;
            border-width: 5px 5px 0;
            content: "";
        }
    }

    &__current,
    &__select {
        @apply block m-0 no-underline cursor-pointer;
        line-height: 14px;
        box-sizing: border-box;
    }

    &__placeholder {
        @apply text-gray-700 inline-block;
    }

    &__input {
        @apply bg-transparent outline-none;

        &::placeholder {
            @apply text-gray-700;
        }
    }

    &__content {
        @apply list-none inline-block p-0 m-0 min-w-full align-top;

        &-wrapper {
            @apply absolute block bg-white max-h-60 overflow-auto border border-t-0 rounded-b z-50 shadow-md;
            left: -1px;
            min-width: calc(100% + 2px);
            top: calc(100% + 1.5px);
        }
    }

    &__current {
        @apply min-h-10 overflow-hidden whitespace-nowrap rounded;
        padding: 8px 30px 0 12px;
        border: 1px solid #e8e8e8;
    }

    &,
    &__input,
    &__single {
        font-family: inherit;
        font-size: 14px;
        touch-action: manipulation;
    }

    &__input,
    &__single {
        @apply truncate relative inline-block min-h-6.5 border-0 rounded w-full mr-4;
        line-height: 20px;
        transition: border 0.1s ease;
        box-sizing: border-box;

        &:hover {
            border-color: #cfcfcf;
        }

        &:focus {
            @apply outline-none;
            border-color: #a8a8a8;
        }
    }

    &__element {
        @apply block;
    }

    &__option {
        @apply block p-2 rounded m-2 h-10 no-underline normal-case align-middle relative cursor-pointer whitespace-nowrap;
        line-height: 24px;

        &::after {
            @apply top-0 right-0 absolute pr-3 pl-6.5;
            line-height: 40px;
        }

        &:hover {
            @apply bg-blue-50;
        }

        // Grouping options --------------------------------------------

        &--group {
            @apply bg-misc-500 text-black-500;

            &.multiselect__option--disabled {
                @apply bg-transparent font-medium #{!important};
            }
        }

        // ------------------------------------------------------------------

        &--highlight {
            @apply bg-misc-500 text-black-500;

            &:after {
                content: attr(data-select);
                background: #e8eefa;
                color: #202123;
            }
        }

        &--selected {
            @apply bg-blue-50 text-blue-500;

            // TODO for select label --------------------------------------------

            // &::after {
            //     content: attr(data-selected);
            //     color: silver;
            // }

            // ------------------------------------------------------------------

            &.multiselect__option--highlight {
                background-color: #e9edf0;

                //TODO for deselect label --------------------------------------------

                // &::after {
                //     background: #fde8e8;
                //     content: attr(data-deselect);
                //     color: #202123;
                // }

                // ------------------------------------------------------------------
            }
        }

        &--disabled {
            @apply text-gray-700 cursor-not-allowed pointer-events-none;
            background: #ededed !important;

            & .multiselect__current,
            & .multiselect__select {
                background: #ededed;
                color: #a6a6a6;
            }

            &.multiselect__option--highlight {
                background: #dedede;
            }
        }
    }

    &__spinner {
        @apply absolute w-12 h-8 bg-white block;
        right: 1px;
        top: 1px;

        &::after,
        &::before {
            @apply absolute -mt-2 mb-0 ml-0 -mr-2 rounded-full border border-transparent;
            content: "";
            top: 50%;
            left: 50%;
            width: 14px;
            height: 14px;
            border-top-color: #e8eefa;
            box-shadow: 0 0 0 1px transparent;
        }

        &::before {
            animation: spinning 2.4s cubic-bezier(0.41, 0.26, 0.2, 0.62);
            animation-iteration-count: infinite;
        }

        &::after {
            animation: spinning 2.4s cubic-bezier(0.51, 0.09, 0.21, 0.8);
            animation-iteration-count: infinite;
        }
    }
}

[dir="rtl"] {
    & .multiselect {
        text-align: right;
    }

    & .multiselect__select {
        right: auto;
        left: 1px;
    }

    & .multiselect__tags {
        padding: 8px 8px 0 40px;
    }

    & .multiselect__content {
        text-align: right;
    }

    & .multiselect__option:after {
        right: auto;
        left: 0;
    }

    & .multiselect__clear {
        right: auto;
        left: 12px;
    }

    & .multiselect__spinner {
        right: auto;
        left: 1px;
    }
}

fieldset[disabled] .multiselect {
    pointer-events: none;
}

@keyframes spinning {
    0% {
        transform: rotate(0);
    }
    to {
        transform: rotate(2turn);
    }
}

//TODO loading ------------------------------------------

// .multiselect__loading-enter-active,
// .multiselect__loading-leave-active {
//     transition: opacity 0.4s ease-in-out;
//     opacity: 1;
// }

// .multiselect__loading-enter,
// .multiselect__loading-leave-active {
//     opacity: 0;
// }

// ------------------------------------------------------

//TODO above -----------------------------------------------------

// .multiselect--above.multiselect--active .multiselect__current,
// .multiselect--above.multiselect--active .multiselect__input,
// .multiselect--above.multiselect--active .multiselect__tags {
//     border-top-left-radius: 0;
//     border-top-right-radius: 0;
// }

// .multiselect--above .multiselect__content-wrapper {
//     bottom: 100%;
//     border-bottom-left-radius: 0;
//     border-bottom-right-radius: 0;
//     border-top-left-radius: 4px;
//     border-top-right-radius: 4px;
//     border-bottom: none;
//     border-top: 1px solid #cfd6e4;
// }

// ---------------------------------------------------------------
